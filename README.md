# Private File

文件加密工具

## 文件协议

| 字节位   | 大小       | 说明      |
|-------|----------|---------|
| 0~1   | 2B       | 文件标识    |
| 2     | 1B       | 协议版本    |
| 3     | 1B       | 加密算法    |
| 4~7   | 4B       | 加密块大小   |
| 8     | 1B       | 摘要算法    |
| 9~28  | 20B      | 原文件摘要值  |
| 29~36 | 8B       | 原文件大小   |
| 37    | 1B       | 密钥长度    |
| M~N   | (N-M+1)B | 密钥      |
| X~Y   | (Y-X+1)B | 加密后的数据  |

均采用小端模式写入数据

### 文件标识

文件标识固定为字符PF，含义为private file的首字母缩写。

### 协议版本

起始版本号为1

### 加密算法

| 标识   | 算法               |
|------|------------------|
| 0x01 | AES256/ECB/PKCS7 |
| ...  | ...              |

### 加密块大小

按照加密块大小对文件进行分割，对每块都采用指定的密钥和算法进行加密。

### 摘要算法

为了确保加解密文件的正确性需要使用摘要算法进行校验

| 标识   | 算法    |
|------|-------|
| 0x01 | MD5   |
| 0x02 | SHA1  |
| ...  | ...   |

摘要算法并不是为了防篡改，因为使用较为快速的摘要算法。

### 原文件摘要值

写入原文件的摘要数据

### 原文件大小

需要写入原文件的字节数

### 密钥长度

当密钥长度不为0时表明将密钥写入了文件，接下来M~N字节为写入的密钥。当值为0时，表明不写入密钥不会存在M~N这段数据

### 密钥

加密解密所需要的密钥，非必须，可能不存在

### 加密后的数据

X~Y为加密后文件的数据